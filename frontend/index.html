<!DOCTYPE html>
<html>
  <head>
    <script src="vue.js" type="text/javascript"></script>

    <script type="text/javascript" src="root_controller.js"></script>
    <script type="text/javascript" src="screen_objects_manager.js"></script>
    <script type="text/javascript" src="compiler.js"></script>
    <script type="text/javascript" src="component.js"></script>
    <script type="text/javascript" src="object_builder.js"></script>
    <script type="text/javascript" src="renderer.js"></script>

    <script type="text/javascript" src="./samples/slideshowloop.js"></script>
    <script src="./samples/slideshowstop.js" type="text/javascript"></script>
    <script src="./samples/slideshowlabel.js" type="text/javascript"></script>
    <script src="./samples/motiontween.js" type="text/javascript"></script>
    <script src="./samples/depth.js" type="text/javascript"></script>
    <script src="./samples/inputtext.js" type="text/javascript"></script>
    <script src="./samples/typing.js" type="text/javascript"></script>
    <script type="text/javascript" src="assets.js"></script>
    <script type="text/javascript">
        const AssetsManager = function () {
          const instance = {};
          instance.find = function (id) {
            return window.dummyAssets[id];
          };
          instance.findAllIds = function () {
            return Object.keys(window.dummyAssets);
          };
          return instance;
        };
      const assetsManager = AssetsManager();
    </script>
    <script src="editor.js" type="text/javascript"></script>
    <script type="text/javascript">
      window.onload = function () {
        const compiler = Compiler(assetsManager);
        const renderer = Renderer();
        const rootController = RootController();
        const component = Component(
          rootController,
          compiler.compile(window.frameEventsTyping),
          ScreenObjectsManager(),
          renderer
        );
        component.play();
        console.debug(component);

        initEditor();
      };
    </script>
    <link href="editor.css" rel="stylesheet">
  </head>
  <body>
    <div id="root" class="player_root" style="display: none;"></div>

    <div id="vue_root">
      <div class="editor_layout">
        <div class="editor_menu">
          ここにメニュー
        </div>
        <div class="editor_columns">
          <div class="editor_left_column">
            <div class="editor_left_column_top">
  
            </div>
            <div class="editor_left_column_bottom">
              <table class="asset_table">
                <tr class="asset_table_th">
                  <th style="width: 45px;">アセットID</th>
                  <th>アセット名</th>
                  <th>種別</th>
                </tr>
                <tr v-for="assetId in assetsManager.findAllIds()" @click="selectAsset(assetId)" :style="assetRowStyle(assetId)">
                  <td class="asset_table_td">{{assetId}}</td>
                  <td class="asset_table_td">{{assetsManager.find(assetId).name}}</td>
                  <td class="asset_table_td">{{assetsManager.find(assetId).type === 'image' ? '画像' : 'テキスト'}}</td>
                </tr>    
              </table>
            </div>
          </div>
          <div class="editor_right_column">
            
            <div v-if="frameEvents">
              <table class="frame_events_table">
                <tr class="frame_events_table_th">
                  <th>フレーム<br />番号</th>
                  <th>フレーム<br />カウント</th>
                  <th>イベント<br />種別</th>
                  <th>深度</th>
                  <th>アクション<br />の動作</th>
                  <th>クリック時の動作</th>
                </tr>
                <tr
                  v-for="(rowItem, index) in frameEvents"
                  :style="frameEventRowStyle(rowItem, index)"
                  @click="selectFrameEvent(index)"
                >
                  <td class="frame_events_table_td">{{rowItem['scheduledFrameNumber']}}</td>
                  <td class="frame_events_table_td">{{rowItem['frameCount']}}</td>
                  <td class="frame_events_table_td">{{eventTypeI18n(rowItem)}}</td>
                  <td class="frame_events_table_td">{{rowItem['depth']}}</td>
                  <td  class="frame_events_table_td">
                    <template v-if="rowItem['executeAction']">
                      {{actionI18n(rowItem['executeAction'])}}<br />
                      <template v-if="rowItem['executeAction']['executeScript']">
                        <textarea
                          style="width: 250px; height: 200px; font-size: 12px"
                        >
      {{rowItem['executeAction']['executeScript']['content']}}</textarea
                        >
                      </template>
                    </template>
                  </td>
                  <td class="frame_events_table_td">
                    <template v-if="rowItem['onClickAction']">
                      {{actionI18n(rowItem['onClickAction'])}}<br />
                    </template>
                  </td>
                </tr>
              </table>
            </div>
      
          </div>
      
        </div>
      </div>


      <div style="display: none;;">
        <button onclick="window.location.reload()">リロード</button>
        <button @click="start" :disabled="!frameEvents || started">再生</button>
        <ul>
          <li>
            <button
              @click="selectStory('frameEventsSlideshowLoop')"
              :disabled="started"
            >
              スライドショーループ
            </button>
          </li>
          <li>
            <button
              @click="selectStory('frameEventsSlideshowStop')"
              :disabled="started"
            >
              スライドショー停止
            </button>
          </li>
          <li>
            <button
              @click="selectStory('frameEventsSlideshowLabel')"
              :disabled="started"
            >
              スライドショーラベル
            </button>
          </li>
          <li>
            <button
              @click="selectStory('frameEventsMotionTween')"
              :disabled="started"
            >
              モーショントゥイーン
            </button>
          </li>
          <li>
            <button
              @click="selectStory('frameEventsDepth')"
              :disabled="started"
            >
              深度
            </button>
          </li>
          <li>
            <button
              @click="selectStory('frameEventsInputText')"
              :disabled="started"
            >
              テキスト入力
            </button>
          </li>
          <li>
            <button
              @click="selectStory('frameEventsTyping')"
              :disabled="started"
            >
              タイピング
            </button>
          </li>
        </ul>
      </div>
    </body>
</html>
